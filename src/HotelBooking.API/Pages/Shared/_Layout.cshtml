@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager
@{
    var isLoggedIn = SignInManager.IsSignedIn(User);
    var username = isLoggedIn ? UserManager.GetUserName(User) : "";
    var title = "Hotel Booking System";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@title - @ViewData["Title"]</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">

    <!-- NAVBAR -->
    <nav class="bg-white border-b border-gray-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">

                <!-- LEFT: Brand + (desktop nav) -->
                <div class="flex items-center space-x-4">
                    <!-- Brand (always visible) -->
                    <a asp-page="/Index" class="flex items-center text-xl font-bold text-blue-600 hover:text-blue-700">
                        🏨 <span class="ml-2">@title</span>
                    </a>

                    <!-- Desktop nav links (hidden on mobile) -->
                    <div class="hidden sm:flex sm:items-center sm:space-x-6">
                        <a asp-page="/Hotels/Index" class="text-gray-700 hover:text-blue-600 font-medium">Hotels</a>
                        @if (isLoggedIn)
                        {
                            <a asp-page="/Bookings/MyBookings" class="text-gray-700 hover:text-blue-600 font-medium">My Bookings</a>
                        }
                    </div>
                </div>

                <!-- RIGHT: Auth actions (hidden on mobile) + mobile toggle -->
                <div class="flex items-center space-x-4">
                    <!-- Auth (desktop only) -->
                    <div class="hidden sm:flex sm:items-center sm:space-x-4">
                        @if (isLoggedIn)
                        {
                            <span class="text-gray-600">Hi, @username!</span>
                            <form asp-page="/Account/Logout" method="post" class="inline">
                                <button type="submit"
                                        class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium">
                                    Logout
                                </button>
                            </form>
                        }
                        else
                        {
                            <a asp-page="/Account/Login" class="text-gray-700 hover:text-blue-600 font-medium">Login</a>
                            <a asp-page="/Account/Register" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium">Register</a>
                        }
                    </div>

                    <!-- Mobile menu button (visible on mobile only) -->
                    <button id="menu-toggle"
                            aria-controls="mobile-menu"
                            aria-expanded="false"
                            class="inline-flex sm:hidden items-center justify-center p-2 text-gray-600 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-md">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                             stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- MOBILE MENU -->
        <!-- Hidden by default; toggled by menu button. Contains nav + auth items for mobile. -->
        <div id="mobile-menu" class="hidden sm:hidden border-t border-gray-200 bg-white">
            <div class="px-4 py-3 space-y-2">
                <a asp-page="/Hotels/Index" class="block text-gray-700 hover:text-blue-600 font-medium">Hotels</a>

                @if (isLoggedIn)
                {
                    <a asp-page="/Bookings/MyBookings" class="block text-gray-700 hover:text-blue-600 font-medium">My Bookings</a>
                    <form asp-page="/Account/Logout" method="post">
                        <button type="submit" class="w-full text-left block text-red-600 hover:text-red-700 font-medium">
                            Logout
                        </button>
                    </form>
                }
                else
                {
                    <a asp-page="/Account/Login" class="block text-gray-700 hover:text-blue-600 font-medium">Login</a>
                    <a asp-page="/Account/Register" class="block text-blue-600 hover:text-blue-700 font-semibold">Register</a>
                }
            </div>
        </div>
    </nav>

    <!-- MAIN -->
    <main class="max-w-7xl mx-auto px-4 py-8">
        @RenderBody()
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-100 border-t py-6 text-center text-sm text-gray-600">
        &copy; @DateTime.Now.Year - @title
    </footer>

    <script>
        // Mobile menu toggle (also manages aria-expanded for accessibility)
        (function () {
            const btn = document.getElementById('menu-toggle');
            const menu = document.getElementById('mobile-menu');
            if (!btn || !menu) return;

            btn.addEventListener('click', () => {
                const isHidden = menu.classList.contains('hidden');
                menu.classList.toggle('hidden');
                btn.setAttribute('aria-expanded', isHidden ? 'true' : 'false');
            });
        })();
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
